(function(){define(["backbone","app","i18n!nls/commons","file_upload","jquery.go-validation"],function(e,t,n,r){var i={upload:n["\uc0ac\uc9c4 \uc62c\ub9ac\uae30"],select_file:n["\ud30c\uc77c \uc120\ud0dd"],alert_max_attach_size:n["\ucca8\ubd80\ud560 \uc218 \uc788\ub294 \ucd5c\ub300 \uc0ac\uc774\uc988\ub294 0MB \uc785\ub2c8\ub2e4."],alert_invalid_attach_file:n["\ud30c\uc77c \uc0ac\uc774\uc988\uac00 0MB \uc774\uc0c1\uc778 \uacbd\uc6b0, \ud30c\uc77c \ucca8\ubd80 \uae30\ub2a5\uc744 \uc774\uc6a9\ud574\uc8fc\uc138\uc694."],alert_max_inline_image_size:n["\uc778\ub77c\uc778 \uc774\ubbf8\uc9c0\ub294 \ucd5c\ub300 0\uac1c\uae4c\uc9c0 \ucca8\ubd80 \uac00\ub2a5\ud569\ub2c8\ub2e4."],alert_format:n["\ud3ec\uba67 \uacbd\uace0"]},s=e.View.extend({events:{},initialize:function(e){this.options=e||{},this.elPlaceHolder=this.options.elPlaceHolder},render:function(){var e=$.goPopup({header:i.upload,width:"250px",pclass:"layer_normal layer_date_set",contents:'<div style="text-align:center"><span class="btn_minor_s" id="imgUpload" style="padding:0 !important;"></span></div>',modal:!0,allowPrevPopup:!0});return this.initFileUpload(this.elPlaceHolder,e),this},initFileUpload:function(e,n){var s=this,o=i.select_file,u={el:"#imgUpload",context_root:GO.contextRoot,button_text:"<span class='buttonText'>"+o+"</span>",url:(GO.instanceType=="admin"?"ad/":"")+"api/file?GOSSOcookie="+$.cookie("GOSSOcookie"),file_type:"*.jpeg;*.jpg;*.gif;*.png;*.bmp",file_types_description:"",accept:"image/*"},a=GO.config("editorConfig")?GO.config("editorConfig").maxInlineImageNumber||100:100,f=0;(new r(u)).queue(function(){f++}).start(function(e,n){var r=n.size/1024/1024;if(10<r)return $.goSlideMessage(t.i18n(i.alert_invalid_attach_file,"arg1","10"),"caution"),!1;var s=n.type.toLowerCase().substring(1),o=new RegExp("(jpeg|jpg|gif|png|bmp)","gi"),u=o.test(s);if(!u)return $.goSlideMessage(i.alert_format,"caution"),!1;if(f>a)return $.goSlideMessage(t.i18n(i.alert_max_inline_image_size,"arg1",a),"caution"),!1}).progress(function(e,t){}).success(function(e,n){var n=n.data;if(!n.thumbnail){$.goSlideMessage(t.i18n(i.alert_invalid_attach_file,"arg1","10"),"caution");return}var r=GO.contextRoot+"thumb/temp/"+n.hostId+"/original"+n.filePath,o='<img data-filename="'+n.fileName+'" data-filepath="'+n.filePath+'" data-hostid="'+n.hostId+'" data-inline="true" src="'+r+'">',u=GO.Editor.getInstance(s.elPlaceHolder);u.setContent(o,!0)}).complete(function(e){f--,f==0&&n.close("",e)}).error(function(e,t){})}});return s})}).call(this);